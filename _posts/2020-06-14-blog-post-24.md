---
title: Time-Optimal Time-Scaling
date: 2020-06-14
permalink: /posts/2012/08/blog-post-24/
author_profile: false
tags:
  - Robotics
  - Continuous Control
---

The trajectory planning problem reduces to finding a time scaling $s(t)$ (see figure). One could choose the time scaling to minimize the energy consumed while meeting a time constraint, or to prevent spilling a glass of water that the robot is carrying. One of the most useful time scalings minimizes the time of motion along the path, subject to the robot's actuator limits. Such time-optimal trajectories maximize the robot's productivity.  

<p align="center"><img src="/images/path.PNG" /></p>  

For most robots, because of state-dependent joint actuator limits and the state-dependent joint dynamics  
<center>$M(\theta)\thheta^{''} + c(\theta,\theta^{'}) + g(\theta) = \tau$</center>  
the maximum available velocities and accelerations change along the path. We now consider the problem of fastest possible time scaling $s(t)$ that respects the robot's actuator limits. We write the actuator's limits as  
<center>$\tau_{i}^{min}(\theta,\theta^{'}) \leq \tau_{i} \leq \tau_{i}^{max}(\theta,\theta^{'})$</center>  

The available actuator torque is typically a function of the current joint speed. For example, for a given maximum voltage of a DC motor, the maximum torque available from the motor drops linearly with the motor’s speed. Before proceeding we recall that the quadratic velocity terms $c(\theta,\theta^{'})$  
<center>$c(\theta,\theta^{'}) = \theta^{'T}\Gamma (\theta)\theta^{'}$</center>  
where $\Gamma (\theta)$ is the three-dimensional tensor of Christoffel symbols constructed from partial derivatives of components of mass matrix $M(\theta)$ w.r.t $\theta$. This form shows more clearly the quadratic dependence on velocities. Now, replacing $\theta^{'}$ by $\frac{d\theta}{ds}s^{'}$ and $\theta^{''}$ by $\frac{d\theta}{ds}s^{''} + \frac{d^{2}\theta}{ds^{2}}s^{'2}$ and reaaranging, we get  
<center>$(M(\theta (s))\frac{d\theta}{ds})s^{''} + (M(\theta (s))\frac{d\theta}{ds}\frac{d^{2}\theta}{ds^{2}} + \frac{d\theta}{ds}^{T} + \Gamma (\theta (s))\frac{d\theta}{ds})s^{'2} + g(\theta (s)) = \tau$</center>  

expressed more compactly as  
<center>$m(s)s^{''} + c(s)s^{'2} + g{s} = \tau$</center>  

where $m(s)$ is the e↵ective inertia of the robot when it is confined to the path $\theta (s)$, $c(s)s^{'2}$ comprises the quadratic velocity terms, and $g(s)$ is the gravitational torque. Similarly, the actuation constraints can be expresses as a function of $s$:  
<center>$\tau_{i}^{min}(s,\s^{'}) \leq \tau_{i} \leq \tau_{i}^{max}(s,s^{'})$</center>  

Substituting the $i^{th}$ component of the previous equation we get  
<center>$\tau_{i}^{min}(s,\s^{'}) \leq m_{i}(s)s^{''} + c_{i}(s)s^{'2} + g_{i}{s} \leq \tau_{i}^{max}(s,s^{'})$</center>  

Let $L_{i}(s,s^{'})$ and $U_{i}(s,s^{'})$ be the minimum and maximum accelerations $s^{''}$ satisfying the $i^{th}$ component of the above equation. Depending on the sign of $m_{i}(s)$, we have three possibilities  
<p align="center"><img src="/images/possib.PNG" /></p>  

And, if $m_{i}(s) = 0$, we have zero inertial point.  

Defining $L(s,s^{'}) = max L_{i} (s,s^{'})$ and $U(s,s^{'}) = min U_{i} (s,s^{'})$, the actuator limits can be defined as state-dependent time-scaling constraints  
<center>$L(s,s^{'}) \leq s^{''} \leq U(s,s^{''})$</center>  

The time-optimal time-scaling can now be stated as  
_Given a path \$theta (s), s \in [0,1]$ an initial state $(s_{0},s_{0}^{'}) = (0,0)$, and a finite state $(s_{f},s_{f}^{'}) = (1,0)$, find a monotonically increasing twice-differentiable time-scaling $s:[0,T] \rightarrow [0,1]$ that  
(a) satisfies $s(0) = s^{'}(0) = s^{'}(T) = 0 and s(T) = 1$ and  
(b) minimizes the total travel time $T$ along the path while respecting the actuator constraints._  

The problem formulation is easily generalized to the case of non-zero initial and final velocities along the path, $s^{'}(0) > 0$ and $s^{'}(T) > 0$.  

