---
title: Trajectory Generation
date: 2020-06-12
permalink: /posts/2012/08/blog-post-23/
author_profile: false
tags:
  - Robotics
  - Continuous Control
---

We will now look at the motion of a robot in terms of time. We analyze various components of a robot's motion (specifically trajectory) in time. But first, define certain terms. The application of robot position as a function of time is called __trajectory__. There are various tasks associated in the design and construction of a robot related to its trajectory. Namely, the task of moving a robot from one position to another in given time is called __trajectory planning__. In such tasks, the trajectory is considered a combination of __paths__, which is a purely geometric description of the sequence of configurations achieved by the robot, and a path, which coherently defines when those configurations are reached. The trajectory may or may not pass through a sequence points called the __via points__.  

__Straight-Line Paths__
======  

A straight line from a start configuraiton $\theta_{start}$ to an end configuration $\theta_{end}$ can be defined either in task space or in configuration space. The advantage of a straight line path in joint space is simplicity: since joints limit are typically of the form $\theta_{i,min} < \theta_{i} < \theta_{i,max}$ for each joint $i$, the allowable joint configurations form a convex set $\Theta_{free}$ in joint space, so the straight line between any two points in $\Theta_{free}$ also lies in $\Theta_{free}$. The equation line for a straight-line path can be written as  
<center>$\theta (s) = \theta_{start} + s(\theta_{end} - \theta_{start})$</center>  

where $s \in [0,1]$. The derivatives can be expressed as  
<center>$\frac{d\theta}{ds} = \theta_{end} - \theta_{start}$</center>  
<center>$\frac{d^{2}\theta}{ds^{2}} = 0$</center>  

Straight lines in joint space generally do not yield any straight-line motion of th eend-effector in task space. I the straight-line motions are desired, the start and end locations $X_{start}$ and $X_{end}$ can be specified in the task space. If $X_{start}$ and $X_{end}$ are specified by a minimum set of coordinates then a straight line is defined as $X(s) = X_{start} + s(X_{end} - X_{start})$, $s \in [0,1]$. As depicted in the figure, compared with the case when joint coordinates are used, the following issues must be addressed:  
1. If the path passes near a kinematic singularity, the joint velocities may become unreasonably large for almost all time scalings of the path.  
2. Since the robot's reachable task space may not be convex in $X$ coordinates, some ponts on a straight line between two reachable endpoints may not be reachable.  
<p align="center"><img src="/images/twocase.PNG" /></p>  


In order to address these issues and eliminate other cases of singularity, it is preferable to decouple the rotational motion from translational motion. Writing $X = (R,p)$ we can define the path  
<center>$p(s) = p_{start} + s(p_{end} - p_{start})$</center>  
<center>$R(s) = R_{start}exp(log(R_{start}^{T}R_{end})s)$</center>  

where the frame origin follows a striaght line while the axis of rotation is constant in the body frame. The below figure illustrates the decoupled path.  
<p align="center"><img src="/images/decoupled.PNG" /></p>  

__Time-scaling a Straight-Line Path__
======  

A time scaling $s(t)$ of a path is essential for smooth motion trajectories and address any constraints on the robot's motion. For a straight line path, the time scaled joint velocities and accelerations are $\theta^{'} = s^{'}(\theta_{end} - \theta_{start})$ and $\theta^{''} = s^{''}(\theta_{end} - \theta{start})$ respectively. These are presented in the below figure.  
<p align="center"><img src="/images/timescale.PNG" /></p>  

__Polynomial Time-scaling__
======  

A convenient form of time scaling is a cubic polynomial fo the kind  
<center>$s(t) = a_{0} + a_{1}t + a_{2}t^{2} + a_{3}t^{3}$</center>  

at $t=0$ and $t=T$ and solving the four constraints for $a_{0},...,a_{3}$ we find  
<center>$a_{0} = 0, a_{1} = 0, a_{2} = \frac{3}{T^{2}}, a_{3} = -\frac{2}{T^{3}}$</center>  

Substituting $s = a_{2}t^{2} + a_{3}t^{3}$ into the straight-line equation gives us  
<center>$\theta (t) = \theta_{start} + (\frac{3t^{2}}{T^{2}} - \frac{2t^{3}}{T^{3}})(\theta_{end} - \theta_{start})$</center>  
<center>$\theta^{'}(t) = \theta_{start} + (\frac{6t}{T^{2}} - \frac{6t^{2}}{T^{3}})(\theta_{end} - \theta_{start})$</center>  
<center>$\theta^{''}(t) = \theta_{start} + (\frac{6}{T^{2}} - \frac{12}{T^{3}})(\theta_{end} - \theta_{start})$</center>  

The maximum joint velocities are achieved at the halfway of motion, $t=\frac{T}{2}$-  
<center>$\theta_{max}^{'} = \frac{3}{2T}(\theta_{end} - \theta_{start})$</center>  

The maximum joint accelerations and decelerations are achieved at $t=0$ and $t=T$-  
<center>$\theta_{max}^{''}  = |\frac{6}{T^{2}}(\theta_{end} - \theta_{start})|$</center>  
<center>$\theta_{min}^{''}  = -|\frac{6}{T^{2}}(\theta_{end} - \theta_{start})|$</center>  





