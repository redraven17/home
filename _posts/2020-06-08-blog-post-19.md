---
title: Manipulator Jacobians and Singularity for Open Chain Effector Control
date: 2020-06-08
permalink: /posts/2012/08/blog-post-19/
author_profile: false
tags:
  - Robotics
  - Continuous Control
---

Up till now we observed the calculation of robot end-effector's position and orientation for a given set of joint positions. We can now look at velocities of the end-effector and analyze its capability in practical task settings. This is particularly useful for modelling complex control tasks and eliminating redundant joints which may not contribute to the robot's workspace capabilities.  

__Velocity Constraints__
====== 
<p align="center"><img src="/images/diag.PNG"></p>  

Before considering the case depicted in figure, lets consider the minimal set of coordinates $x \in \mathbf{R}^{m}$ and the velocity is given by $x^{'} = \frac{dx}{dt} \in \mathbf{R}^{m}$. In this case the forward kinematics can be expressed as-  
<center>$x(t) = f(\theta(t))$</center>  
where $\theta$ is a set of joint variables. By the chain rule of time derivatives we have,  
<center>$x^{'} = \frac{df(\theta)}{d \theta} \frac{d \theta(t)}{dt} = J(\theta)\theta^{'}$</center>  
where $J(\theta) \in \mathbf{R}^{m \times n}$ is the Jacobian.  

Now lets have a look at the 2R planar open chain robot presented in the figure with forward kinematics given by-  
<center>$x_{1} = L_{1}cos\theta_{1} + L_{2}cos(\theta_{1}+\theta_{2})$</center>  
<center>$x_{1} = L_{1}sin\theta_{1} + L_{2}sin(\theta_{1}+\theta_{2})$</center>  

Differentiating both sides w.r.t time gives us-  
<center>$x_{1} = -L_{1}\theta_{1}^{'}sin\theta_{1} - L_{2}(\theta_{1}^{'}+\theta_{2}^{'})sin(\theta_{1}+\theta_{2})$</center>  
<center>$x_{1} = L_{1}\theta_{1}^{'}cos\theta_{1} + L_{2}(\theta_{1}^{'}+\theta_{2}^{'})cos(\theta_{1}+\theta_{2})$</center>  

which can be rearranged into an equation of the form $x^{'} = J(\theta)\theta^{'}$.  
<p align="center"><img src="/images/eq1.PNG"></p>  
Writing the two columns of $J(\theta)$ as $J_{1}(\theta)$ and $J_{2}(\theta)$ and the tip velocity $x^{'}$ as $v_{tip}$-  
<center>$v_{tip} = J_{1}(\theta)\theta_{1}^{'} + J_{2}(\theta)\theta_{2}^{'}$</center>
As long as $J_{1}$ and $J_{2}$ are not collinear, it is possible to generate a tip velocity $v_{tip}$ in any arbitrary direction in the $x_{1}-x_{2}$ plane by choosing appropriate joint velocities $\theta_{1}^{'}$ and $\theta_{2}^{'}$.  On the other hand, if the Jacobian counterparts become collinear, the Jacobian $J(\theta)$ becomes a singular matrix. Such a configuration is called a __singularity__ which is characterized by a situation where the robot tip is unable to generate velocities in certain directions.   

__Manipulator Jacobians__
====== 
In the above 2R planar example we can see that the tip velocity vector and the joint velocity vector are linearly related. The tip velocity vector $v_{tip}$ depends on the corrdinates of interest for the tip, which in turn detemrine the specific form of Jacobian. Other choices of $v_{tip}$ lead to different formulations of Jacobian. The two standard types of Jacobian which we consider are the __Space Jacobian__ and the __Body Jacobian__. Since the derviation from Body Jacobian is exactly same as that of Space Jacobian with the only difference being the position of Transformation matrix (towards the end in the case of body frames), we will only derive the Space Jacobian for this post.  

Lets start by considering an n-link open chain whose forward kinematics is expressed in the following product of exponentials form-  
<center>$T(\theta_{1},...,\theta_{n}) = \exp{[S_{1}]\theta_{1}}\exp{[S_{2}]\theta_{2}}...\exp{[S_{n}]\theta_{n}}M$</center>  
The spatial twist $V_{s}$ is given by $[V_{s}] = T^{'}T^{-1}$, where  
<center>$T^{'} = (\frac{d}{dt}\exp{[S_{1}]\theta_{1}})...\exp{[S_{n}]\theta_{n}}M + (\frac{d}{dt}\exp{[S_{2}]\theta_{2}})...\exp{[S_{n}]\theta_{n}}M + ...$</center>  
<center>$T^{'} = [S_{1}]\theta_{1}^{'}\exp{[S_{1}]\theta_{1}}...\exp{[S_{n}]\theta_{n}}M + [S_{2}]\theta_{2}^{'}\exp{[S_{2}]\theta_{2}}...\exp{[S_{n}]\theta_{n}}M + ...$</center>  

Also,  
<center>$T^{-1} = M^{-1}\exp{-[S_{n}]\theta_{n}}...\exp{-[S_{1}]\theta_{1}}$</center>  
Calculating $T^{'}T^{-1}$ we obtain  
<center>$[V_{s}] = [S_{1}]\theta_{1}^{'} + \exp{[S_{1}\theta_{1}]}[S_{2}]\exp{-[S_{1}\theta_{1}]}\theta_{2}^{'} + ...$</center>  

The above expression can be expressed in the vector form by means of adjoint mapping-  
<center>$V_{s} = S_{1}\theta_{1}^{'} + Ad_{\exp{[S_{1}]\theta_{1}}}S_{2}\theta_{2}^{'} + Ad_{\exp{[S_{1}]\theta_{1}}\exp{[S_{2}]\theta_{2}}}S_{3}\theta_{3}^{'}$</center>  

Observe that $V_{s}$ is a sum of n-spatial twists of the form  
<center>$V_{s} = J_{s1}\theta_{1}^{'} + J_{s2}\theta_{2}^{'} + ... + J_{sn}\theta_{n}^{'}$</center>  
where each $J_{si}(\theta) = (w_{si}(\theta),v_{si}(\theta))$ depends explicitly on the joint values $\theta \in \mathbf{R}^{n}$ for $i=1,2,...n$. In matrix form,  
<center>$V_{s} = \begin{bmatrix} J_{s1} && J_{s2}(\theta) && ... J_{sn}(\theta)\end{bmatrix} \begin{bmatrix} \theta_{1}^{'} \\ \theta_{2}^{'} \\ . \\ . \\ . \\ \theta_{n}^{'}\end{bmatrix}$</center>  
<center>$ = J_{s}(\theta)\theta^{'}$</center>  

The matrix $J_{s}(\theta)$ is said to be the Jacobian in fixed(space) frame coordinates, or more simply the space Jacobian.  

__Singluarity Analysis__
====== 

The Jacobian allows us to identify postures at which a robot's end-effector loses the ability to move instantaneously in one or more diretions. Such a posture is called kinematic singularity, or simply singularity. Mathematically, a singular posture is one in which the Jacobian fails to of maximum rank. To understand why, we consider the body jacobian $J_{b}(\theta)$, whose columns are denoted by $J_{bi}, i=1,2,...,n$. Then,  
<center>$V_{b} = \begin{bmatrix} J_{b1} && J_{b2}(\theta) && ... J_{bn}(\theta)\end{bmatrix} \begin{bmatrix} \theta_{1}^{'} \\ \theta_{2}^{'} \\ . \\ . \\ . \\ \theta_{n}^{'}\end{bmatrix}$</center>  
<center>$V_{b} = J_{b1}\theta_{1}^{'} + J_{b2}\theta_{2}^{'} + ... + J_{bn}\theta_{n}^{'}$</center>  
Thus, the tip frame can achieve twists that are linear combinations of the $J_{bi}$. As long as $n \geq 6$, the maximum rank that $J_{b}(\theta)$ is 6.  

The mathematical definition of singularity is independent of the body or space Jacobian.  

